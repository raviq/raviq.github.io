const toggle = document.querySelector('.nav-toggle'); const nav = document.getElementById('nav'); if (toggle && nav){ toggle.addEventListener('click', ()=>{ const open = nav.classList.toggle('open'); toggle.setAttribute('aria-expanded', open ? 'true':'false'); }); } document.querySelectorAll('a[href^="#"]').forEach(a=>{ a.addEventListener('click', e=>{ const id = a.getAttribute('href').slice(1); const el = document.getElementById(id); if (el){ e.preventDefault(); el.scrollIntoView({behavior:'smooth', block:'start'}); if (nav) nav.classList.remove('open'); history.replaceState(null, '', '#'+id); } }); }); const sections = Array.from(document.querySelectorAll('main section[id]')); const navLinks = Array.from(document.querySelectorAll('.nav a[href^="#"]')); function onScrollSpy(){ const fromTop = window.scrollY + 120; let current = sections[0]; for (const sec of sections){ if (sec.offsetTop <= fromTop) current = sec; } navLinks.forEach(link=>{ link.classList.toggle('active', link.getAttribute('href') === '#' + current.id); }); } window.addEventListener('scroll', onScrollSpy); window.addEventListener('load', onScrollSpy); const backBtn = document.getElementById('backToTop'); if (backBtn){ const toggleBackBtn = () => { if (window.scrollY > 300) { backBtn.style.opacity = '1'; backBtn.style.pointerEvents = 'auto'; } else { backBtn.style.opacity = '0.0'; backBtn.style.pointerEvents = 'none'; } }; backBtn.style.opacity = '0.0'; backBtn.style.transition = 'opacity .25s ease'; backBtn.addEventListener('click', () => window.scrollTo({top:0, behavior:'smooth'})); window.addEventListener('scroll', toggleBackBtn); window.addEventListener('load', toggleBackBtn); } function filterPublications(){ const q = (document.getElementById('pubFilter')?.value || '').toLowerCase(); const y = (document.getElementById('pubYearSelect')?.value || 'all'); document.querySelectorAll('.pub-years ul > li').forEach(li => { const text = li.textContent.toLowerCase(); const okQ = !q || text.includes(q); const okY = y === 'all' || (li.getAttribute('data-year') === y); li.style.display = (okQ && okY) ? '' : 'none'; }); } document.getElementById('pubFilter')?.addEventListener('input', filterPublications); document.getElementById('pubYearSelect')?.addEventListener('change', filterPublications); window.addEventListener('load', filterPublications); (function(){ const root = document.documentElement; const btn = document.querySelector('.theme-toggle'); function applyTheme(t){ if (!t){ root.removeAttribute('data-theme'); return; } root.setAttribute('data-theme', t); } const saved = localStorage.getItem('theme'); if (saved === 'light' || saved === 'dark'){ applyTheme(saved); } if (btn){ btn.addEventListener('click', ()=>{ const cur = root.getAttribute('data-theme'); const next = (cur === 'dark') ? 'light' : 'dark'; applyTheme(next); localStorage.setItem('theme', next); const i = btn.querySelector('i'); if (i){ i.classList.toggle('fa-moon', next==='light'); i.classList.toggle('fa-sun', next==='dark'); i.classList.toggle('fa-regular', false); i.classList.add('fa-solid'); } }); } })(); (function(){ const toggle = document.querySelector('.nav-toggle'); const nav = document.getElementById('nav'); const overlay = document.querySelector('.nav-overlay'); if (!toggle || !nav || !overlay) return; const focusable = () => nav.querySelectorAll('a, button, input, select, textarea, [tabindex]:not([tabindex="-1"])'); let lastFocus = null; function openMenu(){ lastFocus = document.activeElement; nav.classList.add('open'); document.body.classList.add('menu-open'); overlay.classList.add('show'); overlay.hidden = false; const f = focusable(); if (f.length) f[0].focus(); } function closeMenu(){ nav.classList.remove('open'); document.body.classList.remove('menu-open'); overlay.classList.remove('show'); overlay.hidden = true; if (lastFocus) lastFocus.focus(); } toggle.addEventListener('click', ()=>{ if (nav.classList.contains('open')) closeMenu(); else openMenu(); }); overlay.addEventListener('click', closeMenu); document.addEventListener('keydown', (e)=>{ if (!nav.classList.contains('open')) return; if (e.key === 'Escape'){ e.preventDefault(); closeMenu(); } if (e.key === 'Tab'){ const f = Array.from(focusable()); if (!f.length) return; const first = f[0], last = f[f.length-1]; if (e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); } else if (!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); } } }); })(); (function(){ const sec = document.querySelector('#publications'); if (!sec) return; const subnav = sec.querySelector('.pub-subnav .pub-subnav-inner'); const years = Array.from(sec.querySelectorAll('.pub-years h3.year')).map(h=>h.textContent.trim()); if (!subnav || !years.length) return; subnav.innerHTML = ''; const recent = document.createElement('a'); recent.href = '#publications'; recent.className = 'chip'; recent.textContent = 'Recent'; subnav.appendChild(recent); years.forEach(y=>{ const a = document.createElement('a'); a.href = '#pub-' + y; a.className = 'chip'; a.textContent = y; subnav.appendChild(a); }); const title = sec.querySelector('.section-title'); const wrapper = sec.querySelector('.pub-subnav'); function onScroll(){ const y = window.scrollY + 80; const tTop = title ? title.getBoundingClientRect().top + window.scrollY : 0; wrapper.style.opacity = (y > tTop) ? '1' : '0'; wrapper.style.transition = 'opacity .2s ease'; } window.addEventListener('scroll', onScroll); window.addEventListener('load', onScroll); })();